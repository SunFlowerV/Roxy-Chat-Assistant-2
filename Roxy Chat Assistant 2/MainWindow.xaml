<mah:MetroWindow x:Class="Roxy_Chat_Assistant_2.MainWindow"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mah="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
				 xmlns:emoji="clr-namespace:Emoji.Wpf;assembly=Emoji.Wpf"
                 Title="Roxy Chat Assistant"
                 Width="800"
                 Height="450"
                 WindowStartupLocation="CenterScreen"
                 mc:Ignorable="d">

	<Window.Resources>
		<!-- Стиль для сообщений чата с тенью MahApps -->
		<Style x:Key="ChatBubbleStyle" TargetType="Border">
			<Setter Property="BorderThickness" Value="1" />
			<Setter Property="CornerRadius" Value="10" />
			<Setter Property="Padding" Value="15" />
			<Setter Property="Margin" Value="0 5" />
			<Setter Property="HorizontalAlignment" Value="Left" />
			<Setter Property="CornerRadius" Value="15"/>
			<Setter Property="Background" Value="{DynamicResource MahApps.Brushes.Control.Background}"/>
			<Setter Property="Effect">
				<Setter.Value>
					<DropShadowEffect BlurRadius="8" 
                                    ShadowDepth="0" 
                                    Color="#40000000"/>
				</Setter.Value>
			</Setter>
			<Setter Property="Opacity" Value="0" />
			<Setter Property="RenderTransform">
				<Setter.Value>
					<TranslateTransform X="-20" Y="0"/>
				</Setter.Value>
			</Setter>
			<Style.Triggers>
				<DataTrigger Binding="{Binding IsVisible}" Value="True">
					<DataTrigger.EnterActions>
						<BeginStoryboard>
							<Storyboard>
								<!-- Анимация прозрачности -->
								<DoubleAnimation
                            Storyboard.TargetProperty="Opacity"
                            From="0" To="1" 
                            Duration="0:0:0.3"/>

								<!-- Анимация движения -->
								<DoubleAnimation
                            Storyboard.TargetProperty="RenderTransform.(TranslateTransform.X)"
                            From="-20" To="0" 
                            Duration="0:0:0.3"/>
							</Storyboard>
						</BeginStoryboard>
					</DataTrigger.EnterActions>
				</DataTrigger>
			</Style.Triggers>
		</Style>

		<!-- Стиль для кнопки в стиле MahApps -->
		<Style x:Key="ChatButtonStyle" TargetType="Button" BasedOn="{StaticResource MahApps.Styles.Button}">
			<Setter Property="Background" Value="#AD000000"/>
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="FontSize" Value="24"/>
			<Setter Property="Height" Value="60"/>
			<Setter Property="mah:ControlsHelper.CornerRadius" Value="10"/>
			<Setter Property="HorizontalAlignment" Value="Stretch"/>
			<Setter Property="Margin" Value="20,10"/>
		</Style>
	</Window.Resources>

	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="*"/>
			<RowDefinition Height="Auto"/>
		</Grid.RowDefinitions>

		<!-- Область чата -->
		<ScrollViewer x:Name="ChatScrollView" 
                     Grid.Row="0" 
                     Padding="20"
                     VerticalScrollBarVisibility="Auto"
					mah:ScrollViewerHelper.IsHorizontalScrollWheelEnabled="True">
			<ItemsControl ItemsSource="{Binding Messages}">
				<ItemsControl.ItemTemplate>
					<DataTemplate>
						<Border Style="{StaticResource ChatBubbleStyle}" 
								HorizontalAlignment="Left">
							<emoji:TextBlock 
								Text="{Binding Text}" 
								FontSize="24"
								Foreground="{DynamicResource MahApps.Brushes.Text}"
								TextWrapping="Wrap"/>
						</Border>
					</DataTemplate>
				</ItemsControl.ItemTemplate>
			</ItemsControl>
		</ScrollViewer>

		<!-- Кнопка с использованием Command вместо Click -->
		<Button Grid.Row="1"
            Content="Ask me a question"
            Command="{Binding GenerateQuestionCommand}"
            Margin="10"
            Style="{StaticResource MahApps.Styles.Button}"
            Height="40"/>
	</Grid>
</mah:MetroWindow>